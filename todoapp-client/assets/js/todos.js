(function(t){function e(e){for(var n,r,a=e[0],c=e[1],l=e[2],d=0,f=[];d<a.length;d++)r=a[d],i[r]&&f.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(f.length)f.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=o[0]))}return t}var n={},i={todos:0},s=[];function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;s.push([1,"chunk-vendors"]),o()})({1:function(t,e,o){t.exports=o("ea35")},"16c8":function(t,e,o){"use strict";var n=o("6289"),i=o.n(n);i.a},6289:function(t,e,o){},"79fa":function(t,e,o){"use strict";var n=o("afb2"),i=o.n(n);i.a},a56f:function(t,e,o){},a9c2:function(t,e,o){"use strict";var n=o("a56f"),i=o.n(n);i.a},afb2:function(t,e,o){},ea35:function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("097d");var n=o("2b0e"),i=o("e37d"),s=o("d00d"),r=o.n(s),a=o("bc3a"),c=o.n(a),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("header",{staticClass:"header"},[o("h1",[t._v("todos")]),t.featureToggles.auth?o("user-profile"):t._e(),o("input",{directives:[{name:"model",rawName:"v-model",value:t.newTodo,expression:"newTodo"},{name:"tooltip",rawName:"v-tooltip",value:t.newTodoTooltip,expression:"newTodoTooltip"}],staticClass:"new-todo",attrs:{placeholder:"What needs to be done?",autofocus:"on",autocomplete:"off"},domProps:{value:t.newTodo},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.addTodo(e):null},input:function(e){e.target.composing||(t.newTodo=e.target.value)}}})],1),o("section",{staticClass:"main",class:{"loading-mask":t.fetching}},[o("input",{staticClass:"toggle-all",attrs:{id:"toggle-all",type:"checkbox"}}),o("label",{attrs:{for:"toggle-all"}},[t._v("Mark all as complete")]),o("ul",{staticClass:"todo-list"},t._l(t.filteredTodos,function(e){return o("li",{key:e.id,class:{completed:e.completed,editing:e.id==t.editedTodo.id}},[o("div",{staticClass:"view"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.completed,expression:"todo.completed"}],staticClass:"toggle",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.completed)?t._i(e.completed,null)>-1:e.completed},on:{change:[function(o){var n=e.completed,i=o.target,s=!!i.checked;if(Array.isArray(n)){var r=null,a=t._i(n,r);i.checked?a<0&&t.$set(e,"completed",n.concat([r])):a>-1&&t.$set(e,"completed",n.slice(0,a).concat(n.slice(a+1)))}else t.$set(e,"completed",s)},function(o){t.completTodo(e)}]}}),o("label",{on:{dblclick:function(o){t.editTodo(e)}}},[t._v(t._s(e.title))]),o("button",{staticClass:"destroy",on:{click:function(o){t.removeTodo(e,!0)}}})]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"todo.title"},{name:"todo-focus",rawName:"v-todo-focus",value:e.id==t.editedTodo.id,expression:"todo.id == editedTodo.id"}],staticClass:"edit",domProps:{value:e.title},on:{blur:function(o){t.doneEdit(e)},keyup:[function(o){if(!("button"in o)&&t._k(o.keyCode,"enter",13,o.key,"Enter"))return null;t.doneEdit(e)},function(o){if(!("button"in o)&&t._k(o.keyCode,"esc",27,o.key,"Escape"))return null;t.cancelEdit(e)}],input:function(o){o.target.composing||t.$set(e,"title",o.target.value)}}})])}))]),o("footer",{staticClass:"footer"},[o("div",[o("span",{staticClass:"todo-count"},[o("strong",[t._v(t._s(t.todos.length))]),t._v(" item left")]),o("ul",{staticClass:"filters"},[o("li",[o("a",{class:{selected:""===t.filter},attrs:{href:"#/"},on:{click:function(e){t.filtering("")}}},[t._v("All")])]),o("li",[o("a",{class:{selected:"active"==t.filter},attrs:{href:"#/active"},on:{click:function(e){t.filtering("active")}}},[t._v("Active")])]),o("li",[o("a",{class:{selected:"completed"==t.filter},attrs:{href:"#/completed"},on:{click:function(e){t.filtering("completed")}}},[t._v("Completed")])])]),o("button",{staticClass:"clear-completed",on:{click:t.clearCompleted}},[t._v("Clear completed")])]),o("div",[o("online-users-counter",{attrs:{activity:t.featureToggles.onlineUsersCounter}}),o("button",{staticClass:"clear-completed",on:{click:t.downloadTodos}},[t._v("Download todos")])],1)]),o("flash-message",{staticClass:"todo-notification"})],1)},u=[],d=(o("4917"),o("ac6a"),o("f751"),o("53ca")),f=function(t){return!t||/^\s*$/.test(t)},p=function(t){for(var e=1;e<arguments.length;e++){if(null===t||"object"!==Object(d["a"])(t)||!t.hasOwnProperty(arguments[e]))return!1;t=t[arguments[e]]}return!0},h=function(t,e){return p(t.response.data,"error")&&p(t.response.data,"message")?t.response.data.message:"string"===typeof e?e:"예기치 않은 서버 오류가 발생했습니다.\n잠시 후 다시 시도해주세요."},v={isBlank:f,containsKey:p,getErrorMessage:h},m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"user-app"},[o("p",{directives:[{name:"show",rawName:"v-show",value:!t.authorized,expression:"!authorized"}],staticClass:"auth-text"},[t._v("Please "),o("a",{staticClass:"auth-link",attrs:{href:"/login"}},[t._v("login")]),t._v(" to write todos")]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.authorized,expression:"authorized"}],staticClass:"user-profile"},[o("img",{attrs:{src:t.user.profilePictureUrl}}),o("p",[t._v("Welcome your visit to "+t._s(t.user.name))]),o("div",{staticClass:"settings"},[o("button",{attrs:{type:"button"}},[t._v("☰")]),o("div",{staticClass:"buttons"},[o("a",{attrs:{href:"#"},on:{click:function(e){t.$refs.updateProfilePicture.click()}}},[t._v("Update Profile Picture")]),o("input",{ref:"updateProfilePicture",staticClass:"input-file",attrs:{type:"file",accept:"image/*"},on:{change:function(e){t.updateProfilePicture(e)}}}),o("a",{attrs:{href:"/logout"}},[t._v("Log Out")])])])])])},g=[],b={name:"Unknown",profilePictureUrl:"/assets/img/profile-picture.png"},w={data:function(){return{authorized:!1,user:Object.assign({},b)}},mounted:function(){this.fetch()},methods:{fetch:function(){var t=this;this.$http.get("/api/user/profile").then(function(e){t.authorized=!0,t.user=Object.assign(t.user,e.data)}).catch(function(e){t.authorized=!1,t.user=Object.assign({},b),t.flashWarning(v.getErrorMessage(e,"사용자 프로필을 획득하지 못했습니다."))})},updateProfilePicture:function(t){var e=this,o=new FormData;o.append("profilePicture",t.target.files[0]),this.$http.post("/api/user/profile-picture",o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.user=Object.assign(e.user,t.data)}).catch(function(t){e.flashError(v.getErrorMessage(t,"프로필 이미지 변경에 실패했습니다."))})}}},y=w,T=(o("79fa"),o("2877")),_=Object(T["a"])(y,m,g,!1,null,null,null);_.options.__file="UserProfile.vue";var k=_.exports,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"users-currently-count"},[o("span",{staticClass:"count-text"},[t._v(t._s(t.count)+" users currently online")])])},O=[],E=null,P={data:function(){return{count:0}},mounted:function(){this.subscribe()},props:{activity:{type:[String,Boolean],default:!0}},watch:{activity:function(){this.subscribe()}},methods:{isActivity:function(){return"boolean"===typeof this.activity?this.activity:"true"===this.activity},subscribe:function(){if(this.isActivity()){E&&E.close();var t=this;E=new EventSource("/stream/online-users-counter"),E.onmessage=function(e){t.count=e.data?e.data:"unknown"},E.onerror=function(){console.error("접속중인 사용자 수를 획득하지 못했습니다.")}}}}},j=P,x=(o("a9c2"),Object(T["a"])(j,C,O,!1,null,null,null));x.options.__file="OnlineUsersCounter.vue";var $=x.exports,U={data:function(){return{featureToggles:{auth:!1,onlineUsersCounter:!1},newTodo:"",newTodoTooltip:{content:"",show:!1,trigger:"manual",placement:"bottom"},editedTodo:{id:0},fetching:!1,todos:[],filter:""}},mounted:function(){var t=this;this.$http.get("/api/feature-toggles").then(function(e){t.featureToggles=Object.assign(t.featureToggles,e.data)}).catch(function(){console.log("Feature Toggles 정보를 획득하지 못했습니다. 기본 설정을 사용합니다.")}),this.fetch()},components:{UserProfile:k,OnlineUsersCounter:$},computed:{filteredTodos:function(){var t=this.filter;return""===t?this.todos:this.todos.filter(function(e){return"completed"===t?e.completed:!e.completed})}},methods:{addTodo:function(){var t=this;this.newTodo=this.newTodo.trim(),v.isBlank(this.newTodo)||this.$http.post("/api/todos",{id:Date.now(),title:this.newTodo,completed:!1}).then(function(){t.newTodo="",t.fetch()}).catch(function(e){v.containsKey(e.response.data,"errors")&&(setTimeout(function(){return Object.assign(t.newTodoTooltip,{content:"",show:!1})},3e3),Object.assign(t.newTodoTooltip,{content:e.response.data.errors.map(function(t){return"string"===typeof t?t:t.defaultMessage}).join("\n"),show:!0})),t.handleErrorResponse(e)})},completTodo:function(t){this.$http.put("/api/todos/".concat(t.id),t).catch(this.handleErrorResponse)},editTodo:function(t){this.editedTodo=Object.assign({},t,{beforeTitle:t.title})},doneEdit:function(t){var e=this;!this.editedTodo||v.isBlank(t.title.trim())||this.fetching||(t.title=t.title.trim(),this.fetching=!0,this.$http.put("/api/todos/".concat(t.id),t).then(function(){e.fetch()}).catch(this.handleErrorResponse).finally(function(){e.editedTodo={id:0},e.fetching=!1}))},cancelEdit:function(t){t.title=this.editedTodo.beforeTitle,this.editedTodo={id:0}},removeTodo:function(t,e){var o=this;this.$http.delete("/api/todos/".concat(t.id)).then(function(){e&&o.fetch()}).catch(this.handleErrorResponse)},clearCompleted:function(){var t=this,e=this.todos.filter(function(t){return t.completed});e.length>0&&(e.forEach(function(e){return t.removeTodo(e,!1)}),this.fetch())},downloadTodos:function(){this.$http({url:"/todos",method:"GET",headers:{Accept:"text/csv"},responseType:"blob"}).then(function(t){var e=new Blob([t.data],{type:t.data.type}),o=window.URL.createObjectURL(e),n=document.createElement("a"),i=t.headers["content-disposition"],s="unknown";if(i){var r=i.match(/filename="(.+)"/);r&&2===r.length&&(s=r[1])}document.body.appendChild(n),n.href=o,n.setAttribute("download",s),n.click(),n.remove(),window.URL.revokeObjectURL(o)})},fetch:function(){var t=this;this.fetching=!0,this.$http.get("/api/todos").then(function(e){t.todos=e.data}).catch(function(e){t.todos=[],t.handleErrorResponse(e)}).finally(function(){return t.fetching=!1})},filtering:function(t){this.filter=t},handleErrorResponse:function(t){this.flashError(v.getErrorMessage(t))}},directives:{"todo-focus":function(t,e){e.value&&t.focus()}}},A=U,M=(o("16c8"),Object(T["a"])(A,l,u,!1,null,null,null));M.options.__file="Todos.vue";var R=M.exports;n["a"].config.productionTip=!1,n["a"].prototype.$http=c.a,n["a"].use(i["a"]),n["a"].use(r.a,{messageOptions:{timeout:3e3,important:!0,pauseOnInteract:!0}}),new n["a"]({render:function(t){return t(R)}}).$mount("#app")}});
//# sourceMappingURL=todos.js.map